var fs = require('fs'),
    highcharts = require('node-highcharts'),
    minutes = [];

options = {
    chart: {
        defaultSeriesType: 'line',
        marginRight: 25,
        marginBottom: 40,
        plotBackgroundColor: null,
        plotBorderWidth: null,
        plotShadow: false
    },
    title: {
        text: 'Bitstamp VWAP/Last Price',
        x: -20 //center
    },
    subtitle: {
        text: '',
        x: -20
    },
    xAxis: {

        type: 'datetime'
    },
    yAxis: {

        labels: {
            formatter: function() {
                if(this.value === 0.00001){
                    return 0;
                } else {
                    return this.value;
                }
            }
        },
        
        showFirstLabel: false,
        title: {
            text: 'Market Price (USD)'
        },

        plotLines: [{
            width: 1,
            color: '#808080'
        }]

    },

    tooltip: {
        formatter: function() {
            return '<b>'+ this.series.name +'</b> ' + this.y;
        }
    },

    
    plotOptions: {
        series: {
            marker: {
                enabled: false
            }
        }
    },
    

    credits: {
        enabled: false
    },

    legend: {
        layout: 'vertical',
        align: 'right',
        verticalAlign: 'top',
        x: -10,
        y: 100,
        borderWidth: 0
    },

    series: [{
        
    //     name: 'Market Price (USD)',
    //     data: [[1380910505000,133.59297],[1380996905000,137.38172],[1381083305000,136.21887],[1381169705000,137.10394],[1381256105000,136.73281],[1381342505000,138.85832],[1381428905000,140.21331],[1381515305000,140.64634],[1381601705000,141.42238],[1381688105000,143.33601],[1381774505000,149.41995],[1381860905000,152.25552],[1381947305000,157.2206],[1382033705000,153.40576],[1382120105000,160.62448],[1382206505000,178.48081],[1382292905000,181.53101],[1382379305000,190.64537],[1382465705000,197.99909],[1382552105000,209.09625],[1382638505000,208.6843],[1382724905000,192.95],[1382811305000,191.72586],[1382897705000,193.52916],[1382984105000,204.73768],[1383070505000,209.06107],[1383156905000,213.5504],[1383243305000,208.79511],[1383329705000,212.81266],[1383416105000,212.8422],[1383474505387,212.83709]],
    //     showInLegend: false
    // },

    // {
        
    //     name: 'Weighted Price (USD)',
    //     data: [[1380910505000,133.59297],[1380996905000,136.84046999999998],[1381083305000,136.00986285714288],[1381169705000,136.51561714285714],[1381256105000,136.3565614285714],[1381342505000,136.96385],[1381428905000,137.15741999999997],[1381515305000,138.1650442857143],[1381601705000,138.7422814285714],[1381688105000,139.7590157142857],[1381774505000,141.51844571428572],[1381860905000,143.7359757142857],[1381947305000,146.35915857142854],[1382033705000,148.24379428571427],[1382120105000,151.0978142857143],[1382206505000,156.3918757142857],[1382292905000,161.84830428571428],[1382379305000,167.73765],[1382465705000,174.27244571428577],[1382552105000,181.6832528571429],[1382638505000,189.58018714285714],[1382724905000,194.19811857142855],[1382811305000,196.09026857142857],[1382897705000,197.80429000000004],[1382984105000,199.81747714285717],[1383070505000,201.39776000000003],[1383156905000,202.03406714285717],[1383243305000,202.04989714285716],[1383329705000,204.88742000000002],[1383416105000,207.90403999999998],[1383474505387,210.66231571428574]],
    //     showInLegend: false
    // },

    //{
        
        name: 'VWAP',
        data: [[1383512052145,208.52],[1383512112043,208.52],[1383512171924,208.52],[1383512232165,208.51],[1383512292174,208.5],[1383512352227,208.49],[1383512412380,208.5],[1383512472481,208.41],[1383512532517,208.5],[1383512592419,208.5],[1383512652434,208.5],[1383512715206,208.5],[1383512772313,208.53],[1383512832619,208.59],[1383512892581,208.6],[1383512952640,208.58],[1383513013393,208.6],[1383513072549,208.66],[1383513135604,208.38],[1383513192588,208.7],[1383513253978,208.71],[1383513321831,208.72],[1383513372921,208.73],[1383513432728,208.75],[1383513492791,208.79],[1383513553039,208.82],[1383513613079,208.88],[1383513673137,208.89],[1383513733448,208.89],[1383513793235,208.89],[1383513853284,208.93],[1383513913331,208.93],[1383513973339,208.94]],
        showInLegend: false
    },

    {
        
        name: 'Last Price',
        data: [[1383512815607,208.6],[1383512875930,208.6],[1383512936081,208.6],[1383512996077,208.6],[1383513055913,208.67],[1383513119880,208.38],[1383513177555,208.7],[1383513237126,208.71],[1383513296096,208.71],[1383513357144,208.73],[1383513416195,208.75],[1383513475856,208.81],[1383513535855,208.86],[1383513595926,208.86],[1383513655969,208.89],[1383513716367,208.88],[1383513776233,208.91],[1383513836126,208.93],[1383513896143,208.93],[1383513956526,208.94],[1383514016555,208.95]],
        showInLegend: false
    }]

};

highcharts.render(options, function(err, data) {
    if (err) {
        console.log('Error: ' + err);
    } else {
        fs.writeFile('result.png', data);
        return 0;
    }
});